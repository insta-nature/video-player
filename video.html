<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.2.plyr.css">
</head>
<body>
    <div style="height: 400px;">
        <video id="player" controls></video>
    </div>
    <script src="https://cdn.jsdeliver.net/npm/hls.js@latest"></script>
    <script src="https://cdn.plyr.io/3.7.2.plyr.js"></script>
    <!-- <script src="vid.js"></script> -->
    <script>
document.addEventListener('DOMContentLoaded', () => {
    var video = document.getElementById('player');
    var src = 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
    const defaultOptions = {};
    if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(src);
        hls.on(Hls.Events.MANIFEST_PARSED, function(event, data){
            const availableQualities = hls.levels.map((l) => l.height)
            defaultOptions.controls = 
            [
                'play-large',
                'restart',
                'rewind', 
                'play',
                'fast-forward', 
                'progress',
                'current-time',
                'duration', 
                'mute',
                'volume', 
                'captions', 
                'settings',
                'pip', 
                'airplay', 
                'download',
                'fullscreen', 
            ];
            defaultOptions.quality = {
                default: availableQualities[0],
                Options: availableQualities,
                forced: true,
                onChange: (e) => updateQuality(e)
            }
            new plyr(video, defaultOptions);
        });
        hls.attachedMedia(video);
        window.hle = hls;
    }
    function updateQuality(newQuality){
        window.hls.levels.forEach((level, leveIndex) => {
            if (level.height === newQuality) {
                window.hls.currentLevel = leveIndex;
            }
        })
    }
})


    </script>
</body>
</html>